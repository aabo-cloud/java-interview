# 设计模式



## Spring 中的设计模式

### 工厂模式

Spring使用工厂模式可以通过 `BeanFactory` 或 `ApplicationContext` 创建 bean 对象。

#### 简单工厂模式

创建一个工厂类，根据不同类型的需要返回不同的对象。

#### 工厂方法模式

创建一个抽象工厂类，根据各个类的特点先实现不同的工厂，再通过工厂返回不同的对象。

#### 抽象工程模式

抽象了一个工厂接口，需要用到这个接口的就进行实例化，这样可以实现多个接口。

### 单例模式

**Spring 中 bean 的默认作用域就是 singleton(单例)的。** 

在系统中，有一些对象其实我们只需要一个实例，比如说：线程池、缓存、对话框、注册表、日志对象、充当打印机、显卡等设备驱动程序的对象。

**使用单例模式的好处:**

- 对于频繁使用的对象，可以省略创建对象所花费的时间，这对于那些重量级对象而言，是非常可观的一笔系统开销；
- 由于 new 操作的次数减少，因而对系统内存的使用频率也会降低，这将减轻 GC 压力，缩短 GC 停顿时间。

### 代理模式

使用代理对象来代替对真实对象 (real object) 的访问，这样就可以在不修改原目标对象的前提下，扩展目标对象的功能。比如说在目标对象的某个方法执行前后增加一些自定义的操作。

**Spring AOP 就是基于动态代理的**，如果要代理的对象，实现了某个接口，那么Spring AOP会使用**JDK Proxy**，去创建代理对象，而对于没有实现接口的对象，就无法使用 JDK Proxy 去进行代理了，这时候Spring AOP会使用 **Cglib** 生成一个被代理对象的子类来作为代理。

> AOP(Aspect-Oriented Programming:面向切面编程)能够将那些与业务无关，**却为业务模块所共同调用的逻辑或责任（例如事务处理、日志管理、权限控制等）封装起来**，便于**减少系统的重复代码**，**降低模块间的耦合度**，并**有利于未来的可拓展性和可维护性**。

### 模板方法模式

模板方法模式：**定义一个操作的算法骨架，将一些步骤延迟到子类中实现。模板方法使子类可以不改变一个算法的结构即可重定义该算法的某些步骤**。

简单来说，就是将一些相同操作的代码，封装成一个算法的骨架。核心的部分留在子类中实现，在父类中只把那些骨架做好。

> 例如：去银行办业务，银行给我们提供了一个模板就是：先取号，排对，**办理业务（核心部分由子类完成）**，给客服人员评分，完毕。
>
> 这里办理业务是属于子类来完成的，其他的取号，排队，评分则是一个模板。

 spring 中 JDBCTemplate，HibernateTemplate等等用到了。

### 观察者模式

观察者模式是一种对象行为型模式。它表示的是一种对象与对象之间具有依赖关系，当一个对象发生改变的时候，这个对象所依赖的对象也会做出反应。

Spring 事件驱动模型就是观察者模式很经典的一个应用。Spring 事件驱动模型非常有用，在很多场景都可以解耦我们的代码。比如我们每次添加商品的时候都需要重新更新商品索引，这个时候就可以利用观察者模式来解决这个问题。

这个在外呼的项目中有用到过，**调度器** 使用异步的事件监听机制把该任务发布出去。**执行器** 再监听调度器发布的事件。

### 适配器模式

将一个类的接口转换成客户希望的另外一个接口，使得原本由于接口不兼容而不能一起工作的那些类能一起工作。

适配器模式分为类结构型模式和对象结构型模式两种，前者类之间的耦合度比后者高，且要求程序员了解现有组件库中的相关组件的内部结构，所以应用相对较少些。





